<!DOCTYPE html>
<html lang="en">

<head>
  <meta Content-type="application/json" charset=utf-8>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GPS-Трекер</title>
  <link rel="stylesheet" href="style.css">
  <!--eel-->
  <script type="text/javascript" src="/eel.js"></script>
  <!--Bootstrap CSS-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
  <!--Yandex maps API-->
  <script src="https://api-maps.yandex.ru/2.1/?apikey=4ce223fe-fe7c-4837-80fb-1f017bf82ade&lang=ru_RU"
    type="text/javascript"></script>

</head>

<body>



  <div class="container">

    <div class=" d-flex">
      <div class="col-12 card container mt-1">
        <h1 class="text-center">Система перемещения сотрудников</h1>
      </div>
    </div>

    <div class=" d-flex mt-4">
      <div class="col-8 card container">

        <div class="container p-2">
          <div class="map-pos" id="map" style="width: 100%; height: 600px"></div>
        </div>
      </div>



      <div class="col-1"></div>



      <div class="col-3">

        <div class="card container pt-3 pb-3 mb-4">

          <button type="button" class="btn btn-success mb-2 p-3" onclick="location.reload()">Обновить
            информацию</button>
          <button type="button" class="btn btn-danger mt-2 p-3" onclick="window.close()">Выход из приложения</button>

        </div>




        <div class="card container">
          <h2 class="text-center mt-2">Пересечения</h2>
          <table class="table mt-2">
            <thead>
              <tr>
                <th scope="col">ID сотрудника</th>
                <th scope="col"  class="text-center">Контакт (Кол-во)</th>

              </tr>
            </thead>
            <tbody>
              <tr>

                <td>1</td>
                <td class="text-center">2(23), 3(0)</td>

              </tr>
              <tr>

                <td>2</td>
                <td class="text-center">1(23), 3(0)</td>

              </tr>
              <tr>

                <td>3</td>
                <td class="text-center">1(0), 2(0)</td>

              </tr>
              
            </tbody>
          </table>


        </div>
      </div>
    </div>
    <div class=" d-flex mt-4">
      <div class="col-12 card container">
        <h2 class="text-center mt-2">Информация о сотрудниках</h2>
        <table class="table mt-2 text-center" id="users">
          <thead>
            <tr>
              <th scope="col">Цвет</th>
              <th scope="col">ID сотрудника</th>
              <th scope="col">ФИО</th>
              <th scope="col">Возраст</th>
              <th scope="col">Должность</th>
            </tr>
          </thead>
          <tbody>

            <script>
              data = JSON.parse(sessionStorage.getItem('data'));
              var colors = ['#FF0000', '#042ab5', '#04b556'];

              document.querySelector('#users tbody').innerHTML = data[2].map((element, index) => `
                <tr>
                  <td style = "background-color: ${colors[index]} !important;"></td>
                  <td>${element.workerId}</td>
                  <td>${element.workerName}</td>
                  <td>${element.workerAge}</td>
                  <td>${element.workerPosition}</td>
                </tr>
                `).join('');
            </script>

          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
































<script type="text/javascript">


  var colors = ['#FF0000', '#042ab5', '#04b556'];

  //Получаем массивы данных
  eel.expose(call);
  function call(points, result, table) {




    sessionStorage.setItem('data', JSON.stringify(points));

  }

  data = JSON.parse(sessionStorage.getItem('data'));

  console.log(data);

  //Карта
  ymaps.ready(init);
  function init() {
    var myMap = new ymaps.Map("map", {
      center: [55.691044, 37.352471],
      zoom: 15
    });


    data[0].forEach((element, index) => {
      var myPolyline = new ymaps.Polyline(element,
        {
          balloonContent: "Работник № " + (index + 1)
        },
        {
          balloonCloseButton: false,
          strokeColor: colors[index],
          strokeWidth: 4,
          strokeOpacity: 0.9
        });

      myMap.geoObjects

        .add(myPolyline);
    });



  }







</script>


</html>